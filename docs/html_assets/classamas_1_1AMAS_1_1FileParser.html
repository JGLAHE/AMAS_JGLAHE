<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AMAS_JGLAHE: amas.AMAS.FileParser Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AMAS_JGLAHE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classamas_1_1AMAS_1_1FileParser.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classamas_1_1AMAS_1_1FileParser-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">amas.AMAS.FileParser Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aed2f5810db00785248650e58950cc0f2" id="r_aed2f5810db00785248650e58950cc0f2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#aed2f5810db00785248650e58950cc0f2">__init__</a> (self, <a class="el" href="classamas_1_1AMAS_1_1FileParser.html#a1b13db9f81b9781479948aeab67d7194">in_file</a>)</td></tr>
<tr class="separator:aed2f5810db00785248650e58950cc0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c8843201d207275e0d95069cd924e9" id="r_ab2c8843201d207275e0d95069cd924e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#ab2c8843201d207275e0d95069cd924e9">fasta_parse</a> (self)</td></tr>
<tr class="separator:ab2c8843201d207275e0d95069cd924e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef27a175663ef1c0f8338f17b36489d7" id="r_aef27a175663ef1c0f8338f17b36489d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#aef27a175663ef1c0f8338f17b36489d7">phylip_parse</a> (self)</td></tr>
<tr class="separator:aef27a175663ef1c0f8338f17b36489d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d1acfbaaed06f512b1edfa290b1cb12" id="r_a4d1acfbaaed06f512b1edfa290b1cb12"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#a4d1acfbaaed06f512b1edfa290b1cb12">phylip_interleaved_parse</a> (self)</td></tr>
<tr class="separator:a4d1acfbaaed06f512b1edfa290b1cb12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ca6ff0c8a306a7c2d48e23aa261249" id="r_a11ca6ff0c8a306a7c2d48e23aa261249"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#a11ca6ff0c8a306a7c2d48e23aa261249">nexus_parse</a> (self)</td></tr>
<tr class="separator:a11ca6ff0c8a306a7c2d48e23aa261249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d4215e8ff78f2d93225132ed5a9b01" id="r_a55d4215e8ff78f2d93225132ed5a9b01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#a55d4215e8ff78f2d93225132ed5a9b01">nexus_interleaved_parse</a> (self)</td></tr>
<tr class="separator:a55d4215e8ff78f2d93225132ed5a9b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3018704c5d9cc9b88e5660ca114e45a7" id="r_a3018704c5d9cc9b88e5660ca114e45a7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#a3018704c5d9cc9b88e5660ca114e45a7">translate_ambiguous</a> (self, seq)</td></tr>
<tr class="separator:a3018704c5d9cc9b88e5660ca114e45a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e8d0c5b63f538ee02bbb061136c9c3" id="r_aa5e8d0c5b63f538ee02bbb061136c9c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#aa5e8d0c5b63f538ee02bbb061136c9c3">partitions_parse</a> (self)</td></tr>
<tr class="separator:aa5e8d0c5b63f538ee02bbb061136c9c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a1b13db9f81b9781479948aeab67d7194" id="r_a1b13db9f81b9781479948aeab67d7194"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#a1b13db9f81b9781479948aeab67d7194">in_file</a></td></tr>
<tr class="separator:a1b13db9f81b9781479948aeab67d7194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa24582e2a7d2ca2fc703d85b254e1dd4" id="r_aa24582e2a7d2ca2fc703d85b254e1dd4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html#aa24582e2a7d2ca2fc703d85b254e1dd4">in_file_lines</a></td></tr>
<tr class="separator:aa24582e2a7d2ca2fc703d85b254e1dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Parse file contents and return sequences and sequence names</pre> 
<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00538">538</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aed2f5810db00785248650e58950cc0f2" name="aed2f5810db00785248650e58950cc0f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2f5810db00785248650e58950cc0f2">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>in_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00541">541</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  541</span>    <span class="keyword">def </span>__init__(self, in_file):</div>
<div class="line"><span class="lineno">  542</span>        self.in_file = in_file</div>
<div class="line"><span class="lineno">  543</span>        <span class="keyword">with</span> FileHandler(in_file) <span class="keyword">as</span> handle:</div>
<div class="line"><span class="lineno">  544</span>            self.in_file_lines = handle.read().rstrip(<span class="stringliteral">&quot;\r\n&quot;</span>)</div>
<div class="line"><span class="lineno">  545</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab2c8843201d207275e0d95069cd924e9" name="ab2c8843201d207275e0d95069cd924e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c8843201d207275e0d95069cd924e9">&#9670;&#160;</a></span>fasta_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.fasta_parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00546">546</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  546</span>    <span class="keyword">def </span>fasta_parse(self):</div>
<div class="line"><span class="lineno">  547</span>        <span class="comment"># use regex to parse names and sequences in sequential fasta files</span></div>
<div class="line"><span class="lineno">  548</span>        matches = re.finditer(</div>
<div class="line"><span class="lineno">  549</span>            <span class="stringliteral">r&quot;^&gt;(.*[^$])([^&gt;]*)&quot;</span>,</div>
<div class="line"><span class="lineno">  550</span>            self.in_file_lines, re.MULTILINE</div>
<div class="line"><span class="lineno">  551</span>        )</div>
<div class="line"><span class="lineno">  552</span>        records = {}</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">  555</span>            name_match = match.group(1).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  556</span>            seq_match = match.group(2).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).upper()</div>
<div class="line"><span class="lineno">  557</span>            seq_match = self.translate_ambiguous(seq_match)</div>
<div class="line"><span class="lineno">  558</span>            records[name_match] = seq_match</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">return</span> records</div>
<div class="line"><span class="lineno">  561</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AMAS_8py_source.html#l00544">amas.AMAS.FileParser.in_file_lines</a>, and <a class="el" href="AMAS_8py_source.html#l00712">amas.AMAS.FileParser.translate_ambiguous()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classamas_1_1AMAS_1_1FileParser_ab2c8843201d207275e0d95069cd924e9_cgraph.png" border="0" usemap="#aclassamas_1_1AMAS_1_1FileParser_ab2c8843201d207275e0d95069cd924e9_cgraph" alt=""/></div>
<map name="aclassamas_1_1AMAS_1_1FileParser_ab2c8843201d207275e0d95069cd924e9_cgraph" id="aclassamas_1_1AMAS_1_1FileParser_ab2c8843201d207275e0d95069cd924e9_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,252,38"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a3018704c5d9cc9b88e5660ca114e45a7" title=" " alt="" coords="300,5,528,45"/>
<area shape="poly" title=" " alt="" coords="252,23,286,23,286,28,252,28"/>
</map>
</div>

</div>
</div>
<a id="a55d4215e8ff78f2d93225132ed5a9b01" name="a55d4215e8ff78f2d93225132ed5a9b01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55d4215e8ff78f2d93225132ed5a9b01">&#9670;&#160;</a></span>nexus_interleaved_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.nexus_interleaved_parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00671">671</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  671</span>    <span class="keyword">def </span>nexus_interleaved_parse(self):</div>
<div class="line"><span class="lineno">  672</span>        <span class="comment"># use regex to parse names and sequences in sequential nexus files</span></div>
<div class="line"><span class="lineno">  673</span>        <span class="comment"># find the matrix block</span></div>
<div class="line"><span class="lineno">  674</span>        matches = re.finditer(</div>
<div class="line"><span class="lineno">  675</span>            <span class="stringliteral">r&quot;(\s+)?(MATRIX\n|matrix\n|MATRIX\r\n|matrix\r\n)(.*?;)&quot;</span>,</div>
<div class="line"><span class="lineno">  676</span>            self.in_file_lines, re.DOTALL</div>
<div class="line"><span class="lineno">  677</span>        )</div>
<div class="line"><span class="lineno">  678</span>        <span class="comment"># initiate lists for taxa names and sequence strings on separate lines</span></div>
<div class="line"><span class="lineno">  679</span>        taxa = []</div>
<div class="line"><span class="lineno">  680</span>        sequences = []</div>
<div class="line"><span class="lineno">  681</span>        <span class="comment"># initiate a dictionary for the name:sequence records</span></div>
<div class="line"><span class="lineno">  682</span>        records = {}</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">  685</span>            matrix_match = match.group(3)</div>
<div class="line"><span class="lineno">  686</span>            <span class="comment"># get names and sequences from the matrix block</span></div>
<div class="line"><span class="lineno">  687</span>            seq_matches = re.finditer(</div>
<div class="line"><span class="lineno">  688</span>                <span class="stringliteral">r&quot;^(\s+)?[&#39;]?(\S+\s\S+|\S+)[&#39;]?\s+([A-Za-z*?.{}-]+)($|\s+\[[0-9]+\]$)&quot;</span>,</div>
<div class="line"><span class="lineno">  689</span>                matrix_match, re.MULTILINE</div>
<div class="line"><span class="lineno">  690</span>            )</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>            <span class="keywordflow">for</span> match <span class="keywordflow">in</span> seq_matches:</div>
<div class="line"><span class="lineno">  693</span>                name_match = match.group(2)</div>
<div class="line"><span class="lineno">  694</span>                <span class="keywordflow">if</span> name_match <span class="keywordflow">not</span> <span class="keywordflow">in</span> taxa:</div>
<div class="line"><span class="lineno">  695</span>                    taxa.append(name_match)</div>
<div class="line"><span class="lineno">  696</span>                seq_match = match.group(3)</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>                sequences.append(seq_match)</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>        <span class="comment"># initiate a counter to keep track of sequences strung together</span></div>
<div class="line"><span class="lineno">  701</span>        <span class="comment"># from separate lines</span></div>
<div class="line"><span class="lineno">  702</span>        counter = 0</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">for</span> taxon_no <span class="keywordflow">in</span> range(len(taxa)):</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>            full_length_sequence = <span class="stringliteral">&quot;&quot;</span>.join([sequences[index] <span class="keywordflow">for</span> index <span class="keywordflow">in</span> range(counter,len(sequences),len(taxa))])</div>
<div class="line"><span class="lineno">  707</span>            records[taxa[taxon_no]] = self.translate_ambiguous(full_length_sequence).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).upper()</div>
<div class="line"><span class="lineno">  708</span>            counter += 1</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>        <span class="keywordflow">return</span> records</div>
<div class="line"><span class="lineno">  711</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AMAS_8py_source.html#l00544">amas.AMAS.FileParser.in_file_lines</a>, and <a class="el" href="AMAS_8py_source.html#l00712">amas.AMAS.FileParser.translate_ambiguous()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classamas_1_1AMAS_1_1FileParser_a55d4215e8ff78f2d93225132ed5a9b01_cgraph.png" border="0" usemap="#aclassamas_1_1AMAS_1_1FileParser_a55d4215e8ff78f2d93225132ed5a9b01_cgraph" alt=""/></div>
<map name="aclassamas_1_1AMAS_1_1FileParser_a55d4215e8ff78f2d93225132ed5a9b01_cgraph" id="aclassamas_1_1AMAS_1_1FileParser_a55d4215e8ff78f2d93225132ed5a9b01_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,215,45"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a3018704c5d9cc9b88e5660ca114e45a7" title=" " alt="" coords="263,5,491,45"/>
<area shape="poly" title=" " alt="" coords="215,23,249,23,249,28,215,28"/>
</map>
</div>

</div>
</div>
<a id="a11ca6ff0c8a306a7c2d48e23aa261249" name="a11ca6ff0c8a306a7c2d48e23aa261249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11ca6ff0c8a306a7c2d48e23aa261249">&#9670;&#160;</a></span>nexus_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.nexus_parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00645">645</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>    <span class="keyword">def </span>nexus_parse(self):</div>
<div class="line"><span class="lineno">  646</span>        <span class="comment"># use regex to parse names and sequences in sequential nexus files</span></div>
<div class="line"><span class="lineno">  647</span>        <span class="comment"># find the matrix block</span></div>
<div class="line"><span class="lineno">  648</span>        matches = re.finditer(</div>
<div class="line"><span class="lineno">  649</span>            <span class="stringliteral">r&quot;(\s+)?(MATRIX\n|matrix\n|MATRIX\r\n|matrix\r\n)(.*?;)&quot;</span>,</div>
<div class="line"><span class="lineno">  650</span>            self.in_file_lines, re.DOTALL</div>
<div class="line"><span class="lineno">  651</span>        )</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>        records = {}</div>
<div class="line"><span class="lineno">  654</span>        <span class="comment"># get names and sequences from the matrix block</span></div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">  657</span>            matrix_match = match.group(3)</div>
<div class="line"><span class="lineno">  658</span>            seq_matches = re.finditer(</div>
<div class="line"><span class="lineno">  659</span>                <span class="stringliteral">r&quot;^(\s+)?[&#39;]?(\S+\s\S+|\S+)[&#39;]?\s+([A-Za-z*?.{}-]+)($|\s+\[[0-9]+\]$)&quot;</span>,</div>
<div class="line"><span class="lineno">  660</span>                matrix_match, re.MULTILINE</div>
<div class="line"><span class="lineno">  661</span>            )</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>            <span class="keywordflow">for</span> match <span class="keywordflow">in</span> seq_matches:</div>
<div class="line"><span class="lineno">  664</span>                name_match = match.group(2).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  665</span>                seq_match = match.group(3).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).upper()</div>
<div class="line"><span class="lineno">  666</span>                seq_match = self.translate_ambiguous(seq_match)</div>
<div class="line"><span class="lineno">  667</span>                records[name_match] = seq_match</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>        <span class="keywordflow">return</span> records</div>
<div class="line"><span class="lineno">  670</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AMAS_8py_source.html#l00544">amas.AMAS.FileParser.in_file_lines</a>, and <a class="el" href="AMAS_8py_source.html#l00712">amas.AMAS.FileParser.translate_ambiguous()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classamas_1_1AMAS_1_1FileParser_a11ca6ff0c8a306a7c2d48e23aa261249_cgraph.png" border="0" usemap="#aclassamas_1_1AMAS_1_1FileParser_a11ca6ff0c8a306a7c2d48e23aa261249_cgraph" alt=""/></div>
<map name="aclassamas_1_1AMAS_1_1FileParser_a11ca6ff0c8a306a7c2d48e23aa261249_cgraph" id="aclassamas_1_1AMAS_1_1FileParser_a11ca6ff0c8a306a7c2d48e23aa261249_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,257,38"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a3018704c5d9cc9b88e5660ca114e45a7" title=" " alt="" coords="305,5,533,45"/>
<area shape="poly" title=" " alt="" coords="257,23,292,23,292,28,257,28"/>
</map>
</div>

</div>
</div>
<a id="aa5e8d0c5b63f538ee02bbb061136c9c3" name="aa5e8d0c5b63f538ee02bbb061136c9c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e8d0c5b63f538ee02bbb061136c9c3">&#9670;&#160;</a></span>partitions_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.partitions_parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00731">731</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  731</span>    <span class="keyword">def </span>partitions_parse(self):</div>
<div class="line"><span class="lineno">  732</span>        <span class="comment"># parse partitions file using regex</span></div>
<div class="line"><span class="lineno">  733</span>        <span class="comment"># original: `matches = re.finditer(r&quot;^(\s+)?([^ =]+)[ =]+([\\0-9, -]+)&quot;, self.in_file_lines, re.MULTILINE)`</span></div>
<div class="line"><span class="lineno">  734</span>        <span class="comment"># new version: more permissive -&gt; handles PartionFinder/RAxML/(IQ-TREE 2)best_scheme.nex format partition files</span></div>
<div class="line"><span class="lineno">  735</span>        matches = re.finditer(</div>
<div class="line"><span class="lineno">  736</span>            <span class="stringliteral">r&quot;&quot;&quot;^[ \t]*                                 # start of line w/ zero-or-more (just) whitespaces/tabs</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">                (</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">                 (?P&lt;nexus&gt;charset[ ]+)                 # case 1: (IQ-TREE 2)best_scheme.nex partition directive; partition name</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">                 |</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">                 (?P&lt;raxml&gt;[A-Za-z0-9_+\.]+,[ \t]+)     # case 2: RAxML/RAxML-NG model(+other pars); partition name</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">                )?</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">                (?P&lt;partition_name&gt;[A-Za-z0-9_\-]+)     # case 3: just partition name (including one that contain residual &#39;-out&#39;/&#39;-meta&#39; suffixes)</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">                [ ]*=[ ]*                               # whitespace-padded (or unpadded) &#39;=&#39;: (IQ-TREE 2)best_scheme.nex compatabiliy</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">                (?P&lt;numbers&gt;[\\0-9, -]+)                # position ranges w/ stride (multiple intervals; from original regex)</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">                (?P&lt;nexus_term&gt;[ ]*[;])?                # whitespace-prepended (or unprepended) &#39;;&#39; (nexus terminator)</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral">            &quot;&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  747</span>            self.in_file_lines,</div>
<div class="line"><span class="lineno">  748</span>            re.MULTILINE | re.VERBOSE</div>
<div class="line"><span class="lineno">  749</span>        )</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>        <span class="comment"># initiate list to store dictionaries with lists</span></div>
<div class="line"><span class="lineno">  752</span>        <span class="comment"># of slice positions as values</span></div>
<div class="line"><span class="lineno">  753</span>        partitions = []</div>
<div class="line"><span class="lineno">  754</span>        add_to_partitions = partitions.append</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">  757</span>            <span class="comment"># initiate dictionary of partition name as key</span></div>
<div class="line"><span class="lineno">  758</span>            dict_of_dicts = {}</div>
<div class="line"><span class="lineno">  759</span>            <span class="comment"># and list of dictionaries with slice positions</span></div>
<div class="line"><span class="lineno">  760</span>            list_of_dicts = []</div>
<div class="line"><span class="lineno">  761</span>            add_to_list_of_dicts = list_of_dicts.append</div>
<div class="line"><span class="lineno">  762</span>            <span class="comment"># get parition name and numbers from parsed partition strings</span></div>
<div class="line"><span class="lineno">  763</span>            partition_name = match.group(<span class="stringliteral">&#39;partition_name&#39;</span>)</div>
<div class="line"><span class="lineno">  764</span>            numbers = match.group(<span class="stringliteral">&#39;numbers&#39;</span>)</div>
<div class="line"><span class="lineno">  765</span>            <span class="comment"># remove any whitespace padding &#39;-&#39; (to be consistent with partition-writing format)</span></div>
<div class="line"><span class="lineno">  766</span>            numbers = re.sub(<span class="stringliteral">r&quot;[ ]*-[ ]*&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>, numbers)</div>
<div class="line"><span class="lineno">  767</span>            <span class="comment"># find all numbers that will be used to parse positions</span></div>
<div class="line"><span class="lineno">  768</span>            positions = re.findall(<span class="stringliteral">r&quot;([^ ,]+)&quot;</span>, numbers)</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>            <span class="keywordflow">for</span> position <span class="keywordflow">in</span> positions:</div>
<div class="line"><span class="lineno">  771</span>                <span class="comment"># create dictionary for slicing input sequence</span></div>
<div class="line"><span class="lineno">  772</span>                <span class="comment"># conditioning on whether positions are represented</span></div>
<div class="line"><span class="lineno">  773</span>                <span class="comment"># by range, range with stride, or single number</span></div>
<div class="line"><span class="lineno">  774</span>                pos_dict = {}</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>                <span class="keywordflow">if</span> <span class="stringliteral">&quot;-&quot;</span> <span class="keywordflow">in</span> position:</div>
<div class="line"><span class="lineno">  777</span>                    m = re.search(<span class="stringliteral">r&quot;([0-9]+)-([0-9]+)&quot;</span>, position)</div>
<div class="line"><span class="lineno">  778</span>                    pos_dict[<span class="stringliteral">&quot;start&quot;</span>] = int(m.group(1)) - 1</div>
<div class="line"><span class="lineno">  779</span>                    pos_dict[<span class="stringliteral">&quot;stop&quot;</span>] = int(m.group(2))</div>
<div class="line"><span class="lineno">  780</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  781</span>                    pos_dict[<span class="stringliteral">&quot;start&quot;</span>] = int(position) - 1</div>
<div class="line"><span class="lineno">  782</span>                    pos_dict[<span class="stringliteral">&quot;stop&quot;</span>] = int(position)</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>                <span class="keywordflow">if</span> <span class="stringliteral">&quot;\\&quot;</span> <span class="keywordflow">in</span> position:</div>
<div class="line"><span class="lineno">  785</span>                    <span class="comment"># Note: the value of `N` in `...\N` isn&#39;t read: the script simply assumes `N` is consistent with the number of</span></div>
<div class="line"><span class="lineno">  786</span>                    <span class="comment"># increments per interval when the alignment is parsed with a stride of 3 (designating each cpos).</span></div>
<div class="line"><span class="lineno">  787</span>                    <span class="comment"># E.g. For the partition file:</span></div>
<div class="line"><span class="lineno">  788</span>                    <span class="comment">#       ...`1-N\2`</span></div>
<div class="line"><span class="lineno">  789</span>                    <span class="comment">#       ...`2-N\2`</span></div>
<div class="line"><span class="lineno">  790</span>                    <span class="comment">#       ...`(N+1)-M\2`</span></div>
<div class="line"><span class="lineno">  791</span>                    <span class="comment">#       ...`(N+2)-M\2`</span></div>
<div class="line"><span class="lineno">  792</span>                    <span class="comment"># 3&#39;cpos are ignored due to the absence of intervals `3-N...`, `(N+3)-M...`, not because the associated stride values are`\2`</span></div>
<div class="line"><span class="lineno">  793</span>                    pos_dict[<span class="stringliteral">&quot;stride&quot;</span>] = 3</div>
<div class="line"><span class="lineno">  794</span>                <span class="keywordflow">elif</span> <span class="stringliteral">&quot;\\&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> position:</div>
<div class="line"><span class="lineno">  795</span>                    pos_dict[<span class="stringliteral">&quot;stride&quot;</span>] = 1</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>                add_to_list_of_dicts(pos_dict)</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>            dict_of_dicts[partition_name] = list_of_dicts</div>
<div class="line"><span class="lineno">  800</span>            add_to_partitions(dict_of_dicts)</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">return</span> partitions</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AMAS_8py_source.html#l00544">amas.AMAS.FileParser.in_file_lines</a>.</p>

</div>
</div>
<a id="a4d1acfbaaed06f512b1edfa290b1cb12" name="a4d1acfbaaed06f512b1edfa290b1cb12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d1acfbaaed06f512b1edfa290b1cb12">&#9670;&#160;</a></span>phylip_interleaved_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.phylip_interleaved_parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00579">579</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  579</span>    <span class="keyword">def </span>phylip_interleaved_parse(self):</div>
<div class="line"><span class="lineno">  580</span>        <span class="comment"># use regex to parse names and sequences in interleaved phylip files</span></div>
<div class="line"><span class="lineno">  581</span>        tax_chars_matches = re.finditer(</div>
<div class="line"><span class="lineno">  582</span>            <span class="stringliteral">r&quot;^(\s+)?([0-9]+)[ \t]+([0-9]+)&quot;</span>,</div>
<div class="line"><span class="lineno">  583</span>            self.in_file_lines, re.MULTILINE</div>
<div class="line"><span class="lineno">  584</span>        )</div>
<div class="line"><span class="lineno">  585</span>        name_matches = re.finditer(</div>
<div class="line"><span class="lineno">  586</span>            <span class="stringliteral">r&quot;^(\s+)?(\S+)[ \t]+[A-Za-z*?.{}-]+&quot;</span>,</div>
<div class="line"><span class="lineno">  587</span>            self.in_file_lines, re.MULTILINE</div>
<div class="line"><span class="lineno">  588</span>        )</div>
<div class="line"><span class="lineno">  589</span>        seq_matches = re.finditer(</div>
<div class="line"><span class="lineno">  590</span>            <span class="stringliteral">r&quot;(^(\s+)?\S+[ \t]+|^)([A-Za-z*?.{}-]+)$&quot;</span>,</div>
<div class="line"><span class="lineno">  591</span>            self.in_file_lines, re.MULTILINE</div>
<div class="line"><span class="lineno">  592</span>        )</div>
<div class="line"><span class="lineno">  593</span>        <span class="comment"># get number of taxa and chars</span></div>
<div class="line"><span class="lineno">  594</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> tax_chars_matches:</div>
<div class="line"><span class="lineno">  595</span>            tax_match = match.group(2)</div>
<div class="line"><span class="lineno">  596</span>            chars_match = match.group(3)</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>        <span class="comment"># initiate lists for taxa names and sequence strings on separate lines</span></div>
<div class="line"><span class="lineno">  599</span>        taxa = []</div>
<div class="line"><span class="lineno">  600</span>        sequences = []</div>
<div class="line"><span class="lineno">  601</span>        <span class="comment"># initiate a dictionary for the name:sequence records</span></div>
<div class="line"><span class="lineno">  602</span>        records = {}</div>
<div class="line"><span class="lineno">  603</span>        <span class="comment"># initiate a counter to keep track of sequences strung together</span></div>
<div class="line"><span class="lineno">  604</span>        <span class="comment"># from separate lines</span></div>
<div class="line"><span class="lineno">  605</span>        counter = 0</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> name_matches:</div>
<div class="line"><span class="lineno">  608</span>            name_match = match.group(2).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  609</span>            taxa.append(name_match)</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> seq_matches:</div>
<div class="line"><span class="lineno">  612</span>            seq_match = match.group(3).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).upper()</div>
<div class="line"><span class="lineno">  613</span>            seq_match = self.translate_ambiguous(seq_match)</div>
<div class="line"><span class="lineno">  614</span>            sequences.append(seq_match)</div>
<div class="line"><span class="lineno">  615</span>        <span class="comment"># try parsing PHYLUCE-style interleaved phylip</span></div>
<div class="line"><span class="lineno">  616</span>        <span class="keywordflow">if</span> len(taxa) != int(tax_match):</div>
<div class="line"><span class="lineno">  617</span>            taxa = []</div>
<div class="line"><span class="lineno">  618</span>            sequences = []</div>
<div class="line"><span class="lineno">  619</span>            matches = re.finditer(</div>
<div class="line"><span class="lineno">  620</span>                <span class="stringliteral">r&quot;(^(\s+)?(\S+)( ){2,}|^\s+)([ A-Za-z*?.{}-]+)&quot;</span>,</div>
<div class="line"><span class="lineno">  621</span>                self.in_file_lines, re.MULTILINE</div>
<div class="line"><span class="lineno">  622</span>            )</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>            <span class="keywordflow">for</span> match <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">  625</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  626</span>                    name_match = match.group(3).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  627</span>                    taxa.append(name_match)</div>
<div class="line"><span class="lineno">  628</span>                <span class="keywordflow">except</span> AttributeError:</div>
<div class="line"><span class="lineno">  629</span>                    <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  630</span>                seq_match = match.group(5).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).upper()</div>
<div class="line"><span class="lineno">  631</span>                seq_match = <span class="stringliteral">&quot;&quot;</span>.join(seq_match.split())</div>
<div class="line"><span class="lineno">  632</span>                seq_match = self.translate_ambiguous(seq_match)</div>
<div class="line"><span class="lineno">  633</span>                sequences.append(seq_match)</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>        <span class="keywordflow">for</span> taxon_no <span class="keywordflow">in</span> range(len(taxa)):</div>
<div class="line"><span class="lineno">  636</span>            sequence = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><span class="lineno">  637</span>            <span class="keywordflow">for</span> index <span class="keywordflow">in</span> range(counter,len(sequences),len(taxa)):</div>
<div class="line"><span class="lineno">  638</span>                sequence += sequences[index]</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>            records[taxa[taxon_no]] = sequence</div>
<div class="line"><span class="lineno">  641</span>            counter += 1</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>        <span class="keywordflow">return</span> records</div>
<div class="line"><span class="lineno">  644</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AMAS_8py_source.html#l00544">amas.AMAS.FileParser.in_file_lines</a>, and <a class="el" href="AMAS_8py_source.html#l00712">amas.AMAS.FileParser.translate_ambiguous()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classamas_1_1AMAS_1_1FileParser_a4d1acfbaaed06f512b1edfa290b1cb12_cgraph.png" border="0" usemap="#aclassamas_1_1AMAS_1_1FileParser_a4d1acfbaaed06f512b1edfa290b1cb12_cgraph" alt=""/></div>
<map name="aclassamas_1_1AMAS_1_1FileParser_a4d1acfbaaed06f512b1edfa290b1cb12_cgraph" id="aclassamas_1_1AMAS_1_1FileParser_a4d1acfbaaed06f512b1edfa290b1cb12_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,216,45"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a3018704c5d9cc9b88e5660ca114e45a7" title=" " alt="" coords="264,5,492,45"/>
<area shape="poly" title=" " alt="" coords="216,23,250,23,250,28,216,28"/>
</map>
</div>

</div>
</div>
<a id="aef27a175663ef1c0f8338f17b36489d7" name="aef27a175663ef1c0f8338f17b36489d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef27a175663ef1c0f8338f17b36489d7">&#9670;&#160;</a></span>phylip_parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.phylip_parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00562">562</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  562</span>    <span class="keyword">def </span>phylip_parse(self):</div>
<div class="line"><span class="lineno">  563</span>        <span class="comment"># use regex to parse names and sequences in sequential phylip files</span></div>
<div class="line"><span class="lineno">  564</span>        matches = re.finditer(</div>
<div class="line"><span class="lineno">  565</span>            <span class="stringliteral">r&quot;^(\s+)?(\S+)\s+([A-Za-z*?.{}-]+)&quot;</span>,</div>
<div class="line"><span class="lineno">  566</span>            self.in_file_lines, re.MULTILINE</div>
<div class="line"><span class="lineno">  567</span>        )</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>        records = {}</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>        <span class="keywordflow">for</span> match <span class="keywordflow">in</span> matches:</div>
<div class="line"><span class="lineno">  572</span>            name_match = match.group(2).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  573</span>            seq_match = match.group(3).replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).upper()</div>
<div class="line"><span class="lineno">  574</span>            seq_match = self.translate_ambiguous(seq_match)</div>
<div class="line"><span class="lineno">  575</span>            records[name_match] = seq_match</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">return</span> records</div>
<div class="line"><span class="lineno">  578</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="AMAS_8py_source.html#l00544">amas.AMAS.FileParser.in_file_lines</a>, and <a class="el" href="AMAS_8py_source.html#l00712">amas.AMAS.FileParser.translate_ambiguous()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classamas_1_1AMAS_1_1FileParser_aef27a175663ef1c0f8338f17b36489d7_cgraph.png" border="0" usemap="#aclassamas_1_1AMAS_1_1FileParser_aef27a175663ef1c0f8338f17b36489d7_cgraph" alt=""/></div>
<map name="aclassamas_1_1AMAS_1_1FileParser_aef27a175663ef1c0f8338f17b36489d7_cgraph" id="aclassamas_1_1AMAS_1_1FileParser_aef27a175663ef1c0f8338f17b36489d7_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,259,38"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a3018704c5d9cc9b88e5660ca114e45a7" title=" " alt="" coords="307,5,535,45"/>
<area shape="poly" title=" " alt="" coords="259,23,293,23,293,28,259,28"/>
</map>
</div>

</div>
</div>
<a id="a3018704c5d9cc9b88e5660ca114e45a7" name="a3018704c5d9cc9b88e5660ca114e45a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3018704c5d9cc9b88e5660ca114e45a7">&#9670;&#160;</a></span>translate_ambiguous()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.translate_ambiguous </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00712">712</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  712</span>    <span class="keyword">def </span>translate_ambiguous(self, seq):</div>
<div class="line"><span class="lineno">  713</span>        <span class="comment"># translate ambiguous characters from curly bracket format</span></div>
<div class="line"><span class="lineno">  714</span>        <span class="comment"># to single letter format</span></div>
<div class="line"><span class="lineno">  715</span>        <span class="comment"># also remove spaces from sequences</span></div>
<div class="line"><span class="lineno">  716</span>        seq = seq.replace(<span class="stringliteral">&quot;{GT}&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>)</div>
<div class="line"><span class="lineno">  717</span>        seq = seq.replace(<span class="stringliteral">&quot;{AC}&quot;</span>, <span class="stringliteral">&quot;M&quot;</span>)</div>
<div class="line"><span class="lineno">  718</span>        seq = seq.replace(<span class="stringliteral">&quot;{AG}&quot;</span>, <span class="stringliteral">&quot;R&quot;</span>)</div>
<div class="line"><span class="lineno">  719</span>        seq = seq.replace(<span class="stringliteral">&quot;{CT}&quot;</span>, <span class="stringliteral">&quot;Y&quot;</span>)</div>
<div class="line"><span class="lineno">  720</span>        seq = seq.replace(<span class="stringliteral">&quot;{CG}&quot;</span>, <span class="stringliteral">&quot;S&quot;</span>)</div>
<div class="line"><span class="lineno">  721</span>        seq = seq.replace(<span class="stringliteral">&quot;{AT}&quot;</span>, <span class="stringliteral">&quot;W&quot;</span>)</div>
<div class="line"><span class="lineno">  722</span>        seq = seq.replace(<span class="stringliteral">&quot;{CGT}&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>)</div>
<div class="line"><span class="lineno">  723</span>        seq = seq.replace(<span class="stringliteral">&quot;{ACG}&quot;</span>, <span class="stringliteral">&quot;V&quot;</span>)</div>
<div class="line"><span class="lineno">  724</span>        seq = seq.replace(<span class="stringliteral">&quot;{ACT}&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>)</div>
<div class="line"><span class="lineno">  725</span>        seq = seq.replace(<span class="stringliteral">&quot;{AGT}&quot;</span>, <span class="stringliteral">&quot;D&quot;</span>)</div>
<div class="line"><span class="lineno">  726</span>        seq = seq.replace(<span class="stringliteral">&quot;{GATC}&quot;</span>, <span class="stringliteral">&quot;N&quot;</span>)</div>
<div class="line"><span class="lineno">  727</span>        seq = seq.replace(<span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>        <span class="keywordflow">return</span> seq</div>
<div class="line"><span class="lineno">  730</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="AMAS_8py_source.html#l00546">amas.AMAS.FileParser.fasta_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00671">amas.AMAS.FileParser.nexus_interleaved_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00645">amas.AMAS.FileParser.nexus_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00579">amas.AMAS.FileParser.phylip_interleaved_parse()</a>, and <a class="el" href="AMAS_8py_source.html#l00562">amas.AMAS.FileParser.phylip_parse()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classamas_1_1AMAS_1_1FileParser_a3018704c5d9cc9b88e5660ca114e45a7_icgraph.png" border="0" usemap="#aclassamas_1_1AMAS_1_1FileParser_a3018704c5d9cc9b88e5660ca114e45a7_icgraph" alt=""/></div>
<map name="aclassamas_1_1AMAS_1_1FileParser_a3018704c5d9cc9b88e5660ca114e45a7_icgraph" id="aclassamas_1_1AMAS_1_1FileParser_a3018704c5d9cc9b88e5660ca114e45a7_icgraph">
<area shape="rect" title=" " alt="" coords="307,113,535,153"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#ab2c8843201d207275e0d95069cd924e9" title=" " alt="" coords="9,5,255,31"/>
<area shape="poly" title=" " alt="" coords="377,108,322,75,258,46,214,33,216,28,260,41,324,70,380,103"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a55d4215e8ff78f2d93225132ed5a9b01" title=" " alt="" coords="27,55,237,95"/>
<area shape="poly" title=" " alt="" coords="306,113,233,98,234,93,307,107"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a11ca6ff0c8a306a7c2d48e23aa261249" title=" " alt="" coords="6,120,258,145"/>
<area shape="poly" title=" " alt="" coords="293,135,258,135,258,130,293,130"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#a4d1acfbaaed06f512b1edfa290b1cb12" title=" " alt="" coords="27,170,237,210"/>
<area shape="poly" title=" " alt="" coords="307,158,234,173,233,167,306,153"/>
<area shape="rect" href="classamas_1_1AMAS_1_1FileParser.html#aef27a175663ef1c0f8338f17b36489d7" title=" " alt="" coords="5,235,259,260"/>
<area shape="poly" title=" " alt="" coords="380,162,324,195,260,224,216,237,214,232,258,220,322,190,377,158"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1b13db9f81b9781479948aeab67d7194" name="a1b13db9f81b9781479948aeab67d7194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b13db9f81b9781479948aeab67d7194">&#9670;&#160;</a></span>in_file</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.in_file</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00542">542</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="AMAS_8py_source.html#l00532">amas.AMAS.FileHandler.__exit__()</a>, <a class="el" href="AMAS_8py_source.html#l00826">amas.AMAS.Alignment.get_aln_input()</a>, and <a class="el" href="AMAS_8py_source.html#l01002">amas.AMAS.Alignment.get_name()</a>.</p>

</div>
</div>
<a id="aa24582e2a7d2ca2fc703d85b254e1dd4" name="aa24582e2a7d2ca2fc703d85b254e1dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa24582e2a7d2ca2fc703d85b254e1dd4">&#9670;&#160;</a></span>in_file_lines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">amas.AMAS.FileParser.in_file_lines</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="AMAS_8py_source.html#l00544">544</a> of file <a class="el" href="AMAS_8py_source.html">AMAS.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="AMAS_8py_source.html#l00546">amas.AMAS.FileParser.fasta_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00671">amas.AMAS.FileParser.nexus_interleaved_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00645">amas.AMAS.FileParser.nexus_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00731">amas.AMAS.FileParser.partitions_parse()</a>, <a class="el" href="AMAS_8py_source.html#l00579">amas.AMAS.FileParser.phylip_interleaved_parse()</a>, and <a class="el" href="AMAS_8py_source.html#l00562">amas.AMAS.FileParser.phylip_parse()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>amas/<a class="el" href="AMAS_8py_source.html">AMAS.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceamas.html">amas</a></li><li class="navelem"><a class="el" href="namespaceamas_1_1AMAS.html">AMAS</a></li><li class="navelem"><a class="el" href="classamas_1_1AMAS_1_1FileParser.html">FileParser</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
